
# Extract Tagged Lines in Notes

> Obsidian DataviewJS snippet  
> Created: 2025-05-08  
> Tags: `#dataviewjs`, `#tag-query`, `#obsidian`

## ğŸ“ æ¦‚è¦ / Description

Obsidian Valut å†…ã§ã€ç‰¹å®šã®ã‚¿ã‚° (ä¾‹ï¼š`#idea`) ãŒå«ã¾ã‚Œã‚‹ãƒãƒ¼ãƒˆã¨ãã®ã‚¿ã‚°ä»˜ãæ–‡ã‚’æŠœãå‡ºã—ã¦è¡¨å½¢å¼ã§è¡¨ç¤ºã™ã‚‹ã‚¯ã‚¨ãƒªã§ã™ã€‚

This DataviewJS snippet collects notes that include a specific tag (e.g., `#idea`)  
and extracts only the **tagged lines** from those notes. Output will be a table-style summary of the note and the tagged line(s).

---

## ğŸ’» ä½¿ç”¨ä¾‹ / Usecase

- ã‚¿ã‚°ã®ã¤ã„ãŸè¡Œã‚’æŠ½å‡ºã—ã¦æŒ¯ã‚Šè¿”ã‚Šãƒ»é›†è¨ˆãƒ»å¯è¦–åŒ–ã™ã‚‹ç”¨é€”ã«ä¾¿åˆ©
	- `#idea` ã‚¿ã‚°ã‚’æŒ¯ã‚Šè¿”ã‚Šã€ãã®ãƒãƒ¼ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦æ¬¡ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§ã‚ã‚‹ `#ongoing` ã«å¤‰æ›´ã™ã‚‹ã€ã¨ã„ã†é‹ç”¨ãŒæ¥½ã«ãªã‚‹
- ã‚¿ã‚°ã¯ snippet å†…ã®å†’é ­ã§å¤‰æ›´ã§ãã‚‹ã‚ˆã†ãªæ±ç”¨æ€§ã‚’æŒãŸã›ã¦ã„ã¾ã™ã€‚

---

## ğŸ” ã‚¯ã‚¨ãƒªæœ¬ä½“ / DataviewJS Snippet

~~~
```dataviewjs
// ã“ã“ã§ã‚¿ã‚°ã‚’æŒ‡å®š here define the tag you want to search and output
let tagName = "#idea"; // ã“ã“ã‚’å¤‰æ›´ã™ã‚‹ã ã‘ã§å¯¾è±¡ã‚¿ã‚°ã‚’å¤‰ãˆã‚‰ã‚Œã‚‹

let rows = [];
for (let page of dv.pages(tagName)) {
    let content = await dv.io.load(page.file.path);
    // codeblock, inline code å†…ã®ã‚¿ã‚°æ–‡å­—åˆ—ã‚’å¯¾è±¡ã‹ã‚‰å¤–ã™ Exclude the specified tag in code blocks and inline code
    let tags = content.replace(/```[\s\S]*?```/g, '') // Remove code blocks
                       .match(new RegExp(`(?:^|\\n)(?!.*\`.*${tagName}.*\`)[^\\n]*${tagName}[^\\n]*`, 'g'));
    // HTMLã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚’è§£é™¤ã—ã€æ–‡ã®é–“ã«æ”¹è¡Œã‚’è¿½åŠ 
    let formattedTags = tags ? tags.map(tag => tag.replace(/^\s*-\s*/gm, '').replace(/\\n/g, '<br>')).join("<br><br>") + "<br><br>" : "No tags found";
    rows.push([`[[${page.file.name}]]`, formattedTags]);
}

// ã‚¿ã‚¤ãƒˆãƒ«ã‚’è¡¨ã®å‰ã®å†’é ­ã«ç¤ºã™ã ã‘ã®æ§‹æˆã«ã™ã‚‹ Output the title before the table
dv.paragraph(`**\`${tagName}\` ã‚¿ã‚°ä»˜ã‘ã•ã‚ŒãŸãƒãƒ¼ãƒˆã¨æ–‡**`);

// è¡¨ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ ã—ã¦ã€ãƒãƒ¼ãƒˆé–“ã«è–„ã„ç·šã‚’æŒ¿å…¥
dv.table(["Title", "Tagged Texts"], rows, { tableClass: "custom-table" });

// CSSã‚’è¿½åŠ ã—ã¦ã€ç‰¹å®šã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã ã‘è–„ã„ç·šã‚’æŒ¿å…¥
const style = document.createElement('style');
style.textContent = `
.custom-table {
    border-collapse: collapse;
    width: 100%;
}
.custom-table tr {
    border-bottom: 1px solid #ddd;
}
.custom-table tr:last-child {
    border-bottom: none;
}
`;
document.head.appendChild(style);
```
~~~

---

## ğŸ—’ æ³¨æ„ç‚¹ / Notes

- `dv.io.load()` ã‚’ä½¿ã£ã¦ãƒãƒ¼ãƒˆã®ä¸­èº«ã‚’èª­ã¿è¾¼ã‚€ãŸã‚ã€**éåŒæœŸå‡¦ç†ã‚’å«ã‚€DataviewJSãŒæœ‰åŠ¹ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™**
- ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã‚„ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¼ãƒ‰å†…ã®ã‚¿ã‚°ã¯è‡ªå‹•ã§é™¤å¤–ã•ã‚Œã‚‹è¨­è¨ˆã§ã™ï¼ˆæ„å›³ã›ã¬ãƒãƒƒãƒã‚’é˜²ãã¾ã™ï¼‰
- `let tagName = "#idea"` ã®éƒ¨åˆ†ã‚’å¤‰æ›´ã™ã‚Œã°ã€ä»–ã®ã‚¿ã‚°ã«ã‚‚ã™ãå¯¾å¿œå¯èƒ½ã§ã™(ä¾‹ï¼š`#gear`, `#todo`)
- HTMLã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚’è§£é™¤ã—ãŸã†ãˆã§ `<br>` ã‚’å·®ã—è¾¼ã‚“ã§ãŠã‚Šã€è¤‡æ•°ã®æ–‡ã‚‚æ•´ã£ãŸè¡¨ç¤ºã«ãªã‚Šã¾ã™
- è¡¨ã®è¦‹ãŸç›®ã‚’æ•´ãˆã‚‹CSSã‚‚ã‚¹ãƒ‹ãƒšãƒƒãƒˆå†…ã§è‡ªå‹•è¿½åŠ ã•ã‚Œã¾ã™ãŒã€**Obsidianã®ãƒ†ãƒ¼ãƒã‚„ç’°å¢ƒã«ã‚ˆã£ã¦ã¯CSSãŒåŠ¹ã‹ãªã„å ´åˆãŒã‚ã‚Šã¾ã™**
- è¡Œé ­ã« `- ` ãŒã¤ã„ã¦ã„ã‚‹ãƒªã‚¹ãƒˆé …ç›®ã¯ã€è¡¨ç¤ºæ™‚ã«é™¤å»ã•ã‚Œã¦è¦‹ã‚„ã™ãæ•´å½¢ã•ã‚Œã¾ã™
---

## ğŸ“‚ ä½¿ã„æ–¹ / How to Use

1. Dataviewãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
2. ã“ã®ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã‚’ä»»æ„ã®ãƒãƒ¼ãƒˆã«è²¼ã‚Šä»˜ã‘ã‚‹
3. `#idea`  ã‚ã‚‹ã„ã¯ã”è‡ªèº«ã§è¨­å®šã—ãŸ `let tagName = "#hogehoge"` ã®ã‚¿ã‚°ãŒå«ã¾ã‚Œã‚‹ãƒãƒ¼ãƒˆã¨ã€è©²å½“è¡ŒãŒè¡¨ç¤ºã•ã‚Œã¾ã™

---

## âœ… å‹•ä½œç’°å¢ƒ / Compatibility

ã“ã®ã‚¹ãƒ‹ãƒšãƒƒãƒˆã¯ã€ä»¥ä¸‹ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§å‹•ä½œç¢ºèªã‚’è¡Œã„ã¾ã—ãŸï¼š

- **Obsidian v1.8.10**
- **Dataview Plugin v0.5.68**

> ğŸ’¡ ã”åˆ©ç”¨ã®ç’°å¢ƒã«ã‚ˆã£ã¦ã¯ã€ãƒ†ãƒ¼ãƒã‚„ä»–ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®å½±éŸ¿ã§è¡¨ç¤ºã«å·®ãŒå‡ºã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

### âœ… æœ€ä½å‹•ä½œè¦ä»¶ï¼ˆæ¨å®šï¼‰

- **Obsidian v1.1.0 ä»¥ä¸Š**  
  â†’ HTMLè¦ç´ ã®ã‚¹ã‚¿ã‚¤ãƒ«åæ˜ ã‚„DataviewJSã®å®‰å®šå‹•ä½œã®ãŸã‚

- **Dataview Plugin v0.5.0 ä»¥ä¸Šï¼ˆå¿…é ˆï¼‰**  
  â†’ `dv.io.load()` ãŠã‚ˆã³ `await` ã«ã‚ˆã‚‹éåŒæœŸå‡¦ç†å¯¾å¿œãŒå°å…¥ã•ã‚ŒãŸãŸã‚

### âš ï¸ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤ã„ã¨èµ·ã“ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã“ã¨

- `dv.io.load()` ã‚’ä½¿ç”¨ã™ã‚‹éƒ¨åˆ†ã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹
- éåŒæœŸå‡¦ç† (`await`) ãŒæ­£ã—ãå‹•ä½œã—ãªã„
- ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ã‚¹ã‚¿ãƒ CSSãŒåŠ¹ã‹ãªã„ã€ã¾ãŸã¯ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãŒå´©ã‚Œã‚‹

> âœ… **å›°ã£ãŸã¨ãã¯**ï¼š
> - Dataviewãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’æœ€æ–°ç‰ˆã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¦ã¿ã¦ãã ã•ã„
> - Obsidianã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤ã„å ´åˆã€CSSã‚¹ã‚¿ã‚¤ãƒ«ã®åæ˜ ãŒã†ã¾ãã„ã‹ãªã„ã“ã¨ãŒã‚ã‚Šã¾ã™

---

## ğŸ“Œ æ”¹è‰¯ã‚¢ã‚¤ãƒ‡ã‚¢ / Future Ideas

- ç‰¹å®šã®ãƒ•ã‚©ãƒ«ãƒ€å†…ã«é™å®šã—ã¦æŠ½å‡ºã™ã‚‹

---

## ğŸ›¡ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

---
